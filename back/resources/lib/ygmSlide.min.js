var YgmSlide=function(option){this.elId=option.elId;if(!this.elId)return false;this.idx=0;this.loop=false;this.navi=false;this.auto=false;this.autoDuration=2e3;this.popable=false;this.slideEl=document.getElementById(this.elId);this.slideBoxs=this.slideEl.getElementsByClassName("slide-box");this.naviDots=this.slideEl.getElementsByClassName("navi")[0].getElementsByTagName("span");this.viewWidth=this.slideBoxs[0].offsetWidth;this.windowWidth=window.innerWidth;this.pointerFlag=false;this.lastIndex=this.slideBoxs.length-1;this.translate=0;if(option.idx){this.idx=option.idx}if(option.loop!==undefined){this.loop=option.loop}if(option.navi!==undefined){this.navi=option.navi}if(option.auto!==undefined){this.auto=option.auto}if(option.autoDuration!==undefined){this.autoDuration=option.autoDuration}if(option.popable!==undefined){this.popable=option.popable}this.active=function(idx){for(var i=0;i<this.slideBoxs.length;i++){this.slideBoxs[i].classList.remove("active");if(this.navi)this.naviDots[i].classList.remove("active")}this.slideBoxs[idx].classList.add("active");if(this.navi){var dataId=this.slideBoxs[idx].getAttribute("data-id");for(var i=0;i<this.naviDots.length;i++){var naviDataId=this.naviDots[i].getAttribute("data-id");if(naviDataId==dataId){this.naviDots[i].classList.add("active")}}}if(this.loop){if(!this.slideBoxs[idx].previousElementSibling){this.slideEl.getElementsByClassName("slide-wrap")[0].prepend(this.slideBoxs[this.lastIndex]);for(var i=0;i<this.slideBoxs.length;i++){this.slideBoxs[i].style.transform="translateX(-"+this.viewWidth*2+"px)";this.slideBoxs[i].style.transition="0s"}idx++}if(!this.slideBoxs[idx].nextElementSibling){this.slideEl.getElementsByClassName("slide-wrap")[0].append(this.slideBoxs[0]);for(var i=0;i<this.slideBoxs.length;i++){this.slideBoxs[i].style.transform="translateX(-"+this.viewWidth*(this.lastIndex-2)+"px)";this.slideBoxs[i].style.transition="0s"}idx--}var slider=this;setTimeout(function(){for(var i=0;i<slider.slideBoxs.length;i++){slider.slideBoxs[i].style.transform="translateX(-"+slider.viewWidth*idx+"px)";slider.slideBoxs[i].style.transition=".5s"}},1)}else{for(var i=0;i<this.slideBoxs.length;i++){this.slideBoxs[i].style.transform="translateX(-"+this.viewWidth*idx+"px)";this.slideBoxs[i].style.transition=".5s"}}this.idx=idx};var eventStop=function(){event.stopPropagation()};this.autoSlide=function(){var slider=this;if(!slider.auto)return;var autoTime=setInterval(function(){slider.idx++;if(slider.lastIndex<slider.idx){slider.idx=0}slider.active(slider.idx)},slider.autoDuration);slider.autoTime=autoTime};this.clearAutoSlide=function(){if(!this.auto)return;clearInterval(this.autoTime)};this.setNavi=function(){var navi=this.slideEl.getElementsByClassName("navi");var naviMk="";for(var i=0;i<=this.lastIndex;i++){naviMk+="<span data-id="+i+">"+(i+1)+"</span>"}this.slideEl.getElementsByClassName("navi")[0].innerHTML=naviMk};var moveSlideToPrev=function(){this.clearAutoSlide();this.idx--;if(this.idx<0){this.idx=0}this.active(this.idx);this.autoSlide()};var moveSlideToNext=function(){this.clearAutoSlide();this.idx++;if(this.idx>this.lastIndex){this.idx=this.lastIndex}this.active(this.idx);this.autoSlide()};var activePopup=function(){var nowActive=getParentsEl("slide-box active",event.target);var isdim=document.getElementsByClassName("dim").length;if(!isdim&&nowActive){var mkdim=document.createElement("div");mkdim.classList.add("dim");this.bfstyle=JSON.parse(JSON.stringify(nowActive.style));document.body.appendChild(mkdim);this.clearAutoSlide();document.getElementsByClassName("dim")[0].addEventListener("click",removePopup.bind(this));this.translate=Number(this.slideBoxs[0].style.transform.substring(this.slideBoxs[0].style.transform.indexOf("(")+1,this.slideBoxs[0].style.transform.indexOf(")")).replace("px",""));for(var i=0;i<this.slideBoxs.length;i++){this.slideBoxs[i].style.transition="0s"}if(nowActive.previousElementSibling){nowActive.previousElementSibling.style.marginRight=this.viewWidth+"px";this.targetEl=nowActive.previousElementSibling}else{nowActive.nextElementSibling.style.marginLeft=this.viewWidth+"px";this.targetEl=nowActive.nextElementSibling}nowActive.style.transform="translateX("+this.translate+"px) scale(1.5)";nowActive.style.transition=".5s";nowActive.style.position="absolute";nowActive.style.left=-this.translate+"px";nowActive.style.zIndex=10;event.target.removeEventListener("click",activePopup)}};var removePopup=function(){var dim=document.getElementsByClassName("dim");var activeSlide=this.slideEl.getElementsByClassName("slide-box active");this.targetEl.style.marginRight=0;this.targetEl.style.marginLeft=0;activeSlide[0].style.transform=this.bfstyle.transform;activeSlide[0].style.position=this.bfstyle.position;activeSlide[0].style.zIndex=this.bfstyle.zIndex;dim[0].remove();event.target.removeEventListener("click",this);this.autoSlide()};var setStartPoint=function(){if(!event.target.classList.contains("btn")&&!event.target.parentNode.classList.contains("navi")){this.slideEl.setAttribute("s_point",event.pageX);this.pointerFlag=true;this.translate=Number(this.slideBoxs[0].style.transform.substring(this.slideBoxs[0].style.transform.indexOf("(")+1,this.slideBoxs[0].style.transform.indexOf(")")).replace("px",""));this.clearAutoSlide()}};var moveSlide=function(){if(this.pointerFlag){var startPoint=Number(this.slideEl.getAttribute("s_point"));for(var i=0;i<this.slideBoxs.length;i++){this.slideBoxs[i].style.transform="translateX("+(this.translate-startPoint+event.pageX)+"px)";this.slideBoxs[i].style.transition="0s"}}};var activeSlideWithPoint=function(){if(this.pointerFlag&&!event.target.classList.contains("btn")&&!event.target.parentNode.classList.contains("navi")){this.pointerFlag=false;var nowTranslate=Number(this.slideBoxs[0].style.transform.substring(this.slideBoxs[0].style.transform.indexOf("(")+1,this.slideBoxs[0].style.transform.indexOf(")")).replace("px",""));var idx=Math.abs(Math.round(nowTranslate/this.viewWidth));if(nowTranslate>0)idx=0;else if(nowTranslate<-(this.slideBoxs.length*this.viewWidth))idx=this.lastIndex;if(idx>this.lastIndex)idx=this.lastIndex;this.active(idx)}};var activeSlideWithNavi=function(){var dataId=event.target.getAttribute("data-id");for(var i=0;i<this.slideBoxs.length;i++){var slideDataId=this.slideBoxs[i].getAttribute("data-id");if(slideDataId==dataId){this.active(i)}}};this.evntBind=function(){this.slideEl.getElementsByClassName("btn-p")[0].addEventListener("click",moveSlideToPrev.bind(this));this.slideEl.getElementsByClassName("btn-n")[0].addEventListener("click",moveSlideToNext.bind(this));if(this.navi){for(var i=0;i<this.naviDots.length;i++){this.naviDots[i].addEventListener("click",activeSlideWithNavi.bind(this))}}this.slideBoxs[0].addEventListener("transitionstart",function(){document.addEventListener("click",eventStop,{capture:true})});this.slideBoxs[0].addEventListener("transitionend",function(){document.removeEventListener("click",eventStop,{capture:true})});if(this.popable){for(var i=0;i<this.slideBoxs.length;i++){this.slideBoxs[i].addEventListener("click",activePopup.bind(this))}}else{this.slideEl.addEventListener("mousedown",setStartPoint.bind(this));this.slideEl.addEventListener("mouseup",activeSlideWithPoint.bind(this));this.slideEl.addEventListener("mousemove",moveSlide.bind(this));this.slideEl.addEventListener("mouseout",activeSlideWithPoint.bind(this))}window.addEventListener("resize",resize.bind(this))};this.init=function(){for(var i=0;i<this.slideBoxs.length;i++){this.slideBoxs[i].setAttribute("data-id",i)}if(this.auto){this.clearAutoSlide();this.autoSlide()}if(this.navi){this.setNavi()}this.active(this.idx);this.evntBind();var slider=this};function resize(){this.viewWidth=this.slideBoxs[0].offsetWidth;this.active(this.idx)}function getParentsEl(name,node){while(node){var nameArr=name.split(" ");var flag=true;for(var i=0;i<nameArr.length;i++){if(node.tagName=="BODY")return;flag=node.classList.contains(nameArr[i]);if(!flag)break}if(flag)return node;if(!node.parentNode)return;node=node.parentNode}}this.init()};